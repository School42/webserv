# Test configuration for routing

server {
	listen 8080;
	server_name localhost example.com;
	root /var/www/html;
	
	# Root location
	location / {
		allowed_methods GET POST;
		index index.html;
	}
	
	# API location
	location /api {
		allowed_methods GET POST DELETE;
		root /var/www/api;
	}
	
	# Uploads
	location /uploads {
		allowed_methods GET POST;
		root /var/www/uploads;
		client_max_body_size 10M;
	}
	
	# Redirect
	location /old {
		return 301 /new;
	}
	
	# External redirect
	location /google {
		return 302 https://www.google.com;
	}
	
	# CGI
	location /cgi-bin {
		root /usr/lib/cgi-bin;
		cgi_extension .py .sh;
		allowed_methods GET POST;
	}
}

# Second server (virtual host)
server {
	listen 8080;
	server_name api.localhost;
	root /var/www/api-server;
	
	location / {
		allowed_methods GET POST DELETE;
	}
	
	location /v1 {
		allowed_methods GET POST;
		root /var/www/api/v1;
	}
}

# Third server on different port
server {
	listen 9090;
	root /var/www/admin;
	
	location / {
		allowed_methods GET;
	}
}